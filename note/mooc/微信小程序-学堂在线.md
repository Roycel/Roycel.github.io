## 1 导论

### 1.1 互联网软件的开发流程

1. 通过调研确定用户需求，写出需求文档，产品经理根据需求文档做出产品原型(或者叫产品demo)，是团队所有人达成的共知的可视化体系

   UI设计师根据产品原型进行功能界面的设计，前端工程师根据UI设计师设计的界面进行前端界面开发，后端工程师根据产品原型进行数据库设计然后开发后端接口，前端工程师在此基础上将前后端打通就可以发布上线

2. 角色认知：

   - 产品经理：完成需求调研、书写需求文档、用原型工具制作产品demo
   - 小程序前端工程师：前端界面开发、服务端接口对接、测试、发布上线
   - 服务端后台工程师：数据库设计、服务端接口开发
   - 团队负责人：把握方向、合理分工分期、解决各种困难



## 2 真实需求诞生

1. 从用户角度挖掘真实需求，减少伪需求

   可以用户深度访谈、竞品分析、掌握**付费意愿**情况

2. 需求分期，小步快跑，快速迭代

   最小化可行产品（mvp）

## 3 产品原型设计实践

1. 推荐产品原型设计工具墨刀和Axure

   Axure：可以快速创建应用软件、创建Web网站的线框图、流程图、原型、规格说明文档。是专业的，而且可以设计移动端和PC端的原型

   墨刀：易用，只适用于移动端

### 3.1 用户体验地图及功能页面归纳

1. 用户体验地图：通过画一张图，从一个特定用户的角度出发，记录下他与产品或服务进行接触、进入、互动的完整过程

   比如，纵轴是不爽、一般、爽，横轴是使用路径、服务触点

> 剩余主要是墨刀的界面操作演示，没法录入

## 4 小程序前端开发实战

1. 开发工具：微信开发者工具+阿里巴巴icon+css取色器
2. 健壮性：对于规范要求以外的输入能够判断出这个输入不符合规范要求并能有合理的处理方式

### 4.1 微信开发者工具介绍

1. 未注册的代码只能运行在本地的开发者工具中，注册后可以按步骤上传代码到平台，可以配置小程序的信息和相关功能

   注册填写邮箱、密码等就可以得到一个小程序账号

2. 版本管理分为线上版本、审核版本、开发版本

3. 管理员是小程序的创建者（创建账号时设置的微信账号）、项目成员是小程序的开发人员，可以设置不同的权限、体验成员是可以对上传的体验版本进行体验的人员

4. 开发设置包括AppID和AppSecret(小程序密钥，只展示一次)，这是服务器开发的时候需要的设置

   紧接着是服务器域名

5. 新建工程时语言选择JavaScript

6. 开发工具界面中的编译选项可以在进入场景里选择从扫描二维码进入等类型的编译，这样编译后左边的模拟器就会模拟对应场景的情况

   调试时可以通过console口、预览、真机调试等方式，console口可以通过console.log("")来打印信息

   预览在工具栏，使用后生成二维码，扫描后可以体验到对应的小程序

   真机调试时，手机和调试窗口是互通的，相当于把左边的模拟器搬到了手机上

   清除缓存主要是登录的、授权的等等，根据情况按需决定

7. 开发完成后可以在界面中的提交，确定版本号和描述，就可以在平台上看见最新提交的体验版，体验没有问题后，就可以提交审核，审核通过即可点击发布成为线上版本

### 4.2 微信小程序代码框架介绍

1. 微信小程序代码框架Html(wxml)+Css(wxss)+Js

   Html搭建骨架，图片链接、输入框、按钮等

   Css进行美化，给页面元素加上大小、颜色、位置、形状等

   js给组件添加需要的动态效果

2. 小程序代码文件类型：

   .json配置文件 用于配置属性

   .wxml模板文件 用于描述页面的结构

   .wxss样式文件 用于描述页面的样子

   .js脚本逻辑文件 用来处理页面和用户的交互

   .png .jpg图片文件

3. 小程序工程目录：

   pages文件夹：

   存放小程序页面的代码，每个页面为一个文件夹，文件夹名称即为页面名称，文件夹下为该页面的全部代码，共四个文件来描述这个页面，且四个文件名称均与页面名称相同(*.json *.wxml *.wxss *.js)

   utils文件夹：

   仅有一个.js文件，用于存放公共的js代码，方便在不同页面调用

   imagers文件夹：

   方便管理图片，通常也在根目录创建这个文件夹

   app.js/json/wxss：

   根目录下除了上述文件夹外的三个单独的文件，是项目全局的数据和动作，可以在页面中直接使用或访问

   project.config.json：

   项目配置文件，通常不需要程序员改动

4. JSON是一种数据格式，不是编程语言，在小程序中扮演静态配置角色

   app.json是小程序所有页面路径、界面表现、网络超时时间、底部tab等

   ​	pages字段用于描述所有页面路径

   ​	windows字段定义了所有页面顶部背景颜色，文字颜色定义等

   project.config.json工具配置是使用IDE时对界面的一些配置

   json文件中无法使用注释

5. 第一次开发时可以在小程序开发文档中选择框架-小程序配置-查看全部配置项及说明

### 4.3 微信小程序wxml学习

1. WXML(Weixin Markup Language)是从HTML(HyperText Markup Language，超文本标记语言)衍生出来的一种专门在小程序前端页面使用的语言，结合基础组件、事件系统，可以构建出页面的结构

2. wxml与html一样使用**标记标签**来描述页面结构，页面内容写在标签内部，由尖括号包围的关键词构成，可以分为两类：

   成对出现的标签：有开始标签和结束标签，内容写在两个标签之间

   ​	基本结构为：<关键词>内容</关键词>，例如view组件

   不成对出现的标签：

   ​	基本结构为：<关键词/>，例如输入框<input/>

   > view为视图容器，内部能够放置其他组件，就需要有开头和结尾进行标识

   > 注释的结构为<!--注释内容-->  

3. wxml组件的属性设置：

   基本格式：

   > <关键词 属性名称=“属性值”>或<关键词 属性名称=“属性值”/>

   常见属性：

   > class指定了组件的样式；id是组件id，方便在大量相同类型组件中确定其中一个；style也是组件样式，但是class中的样式需要在wxss中提前写好每一组样式，可以直接在wxml反复调用，使用名称即可。style必须将css的样式代码全部写在这里，方便动态展示样式；bindtap可以给组件的特定事件绑定一个处理函数；hidden决定是否隐藏等等。这些都是通用属性

   wxml的属性分为通用属性和专用属性两类

4. 数据绑定：通过{{}}语法把一个变量绑定到界面上

   使用方法：wxml文件：在标签内容或属性中使用：{{变量名}}

   ​                    js文件：对该变量进行定义

   当wxml在加载组件及组件的属性时，会自动将该格式下的变量名拿到js文件中寻找，并将数据值渲染到页面上

   使用位置：

   ​		内容<view>{{message}}</view>

   ​		组件属性(需在双引号内)<view id="item-{{id}}"></view>

   ​		控制属性(需在双引号内)<view wx:if="{{condition}}"></view>

   ​		关键字(需在双引号内)<checkbox checked="{{false}}"></checkbox>这里的false是布尔类型

   ​		在{{}}内运算：

   ​				三目运算：<view hidden="{{flag ? true : false}}">Hidden</view>

   ​				算术运算：<view>{{a+b}}+{{c}}+d</view>

5. 小程序里if/else、for这些控制能力都用wx:开头的属性来表达，也就接下来要讲的列表渲染和条件渲染

6. 列表渲染：

   在组件上使用wx:for控制属性绑定一个数组，即可使用数组中各项的数据重复渲染该组件

   默认数组的当前下标变量名默认为index，数组当前项的变量名默认为item

7. 条件渲染：

   在框架中，使用wx:if="{{condition}}"来判断是否需要渲染该代码块

   > 如果要一次判断多个组件标签，可以用<block>
   >
   > <block wx:if="{{true}}">
   >
   > ​				<view>view1</view>
   >
   > ​				<view>view2</view>
   >
   > </block>

### 4.4 微信小程序wxss学习

1. WXSS(WeiXin Style Sheets)用于描述WXML的组件样式，是由CSS(Cascading Style Sheets)修改扩充而来，因而具备了CSS的大部分特性

2. 基本语法：

   > 选择器{
   >
   > ​	属性：属性值；      一对属性和属性值称为声明
   >
   > ​	···
   >
   > }                                    这个引用框内加起来就是声明块

   选择器指明针对哪些wxml组件使用此样式，比如.txt就指的是wxml中样式属性是.txt格式的组件

   尺寸单位：

   rpx(responsive pixel)，是微信为了方便对分辨率进行适应做的设计，可以根据屏幕宽度自适应。规定页面最大宽度750rpx

   内联样式：

   框架组件上支持使用style、class属性来控制组件的样式

   选择器：

   ​	id选择器：整个代码里，只能有一个，不能重名

   ​	class选择器：整个代码里，可以同名很多个(前面提到的.txt)

3. 盒子模型：所有html元素都可以当作一个盒子，可以分为实际内容(content)、内边距(padding)、边框(border)、外边距(margin)

> wxss中的注释是/**/格式

### 4.5 微信小程序js学习

1. 小程序框架系统分为两部分：逻辑层(app service)、视图层(view)

2. js中的注释：单行//，多行/**/

   小程序开发框架的逻辑层使用Javascript引擎为小程序开发者提供JavaScript代码的运行环境以及微信小程序的特有功能

3. js作为一种轻量级的编程语言广泛用于web开发，但小程序与浏览器存在本质区别，小程序是基于微信app，所以js在web的一些能力无法使用

4. js创建变量都是var 变量名，具体是什么数据类型取决于赋值的类型

   js数据类型：

   ​		字符串，可以是引号中的任意文本，不论单双引号只要成对即可

   ​		数字，可以带小数点，也可以不带

   ​		布尔类型，只能有true或false

   ​		数组，下标从0开始，正常

   ​		undefined和null，undefined表示这个变量不含值

   ​		对象，花括号分隔，括号内对象的属性以名称和值成对定义，属性间逗号隔开。对象属性有两种寻址方式：

   > name=person.lastname;
   >
   > name=person["lastname"];

5. js文件的基本结构：

   注册页面：page方法

   ~~~JavaScript
   Page({
       //这里是页面内容
   })
   ~~~

   页面数据：data对象

   ~~~JavaScript
   data:{
       msg:'hello MINA!',
       flag:false
   },
   ~~~

   page方法的内容中主要有两种格式，一个是data对象，一个是js函数

   ~~~JavaScript
   函数名： function(参数){
       //函数内容
   }，
   ~~~

6. 小程序生命周期和回调函数

   onLoad():在页面加载时触发，一个页面只会调用一次，可以在onLoad的参数中获取打开当前页面路径中的参数

   onShow():页面显示/切入前台时触发

   onReady():页面初次渲染完成时触发。一个页面只会调用一次，代表页面已经准备妥当，可以和视图层进行交互

   当onReady执行后页面就进入激活状态，当页面进入激活状态后

   onShow:页面显示/切入前台时触发

   onHide:页面隐藏/切入后台时触发

   onUnload:页面卸载时触发

7. 事件：

   事件是视图层到逻辑层的通讯方式，可以将用户的行为反馈到逻辑层进行处理，可以绑定在组件上，当达到触发事件，就会执行逻辑层中对应的事件处理函数。事件对象可以携带额外信息

   事件响应：

   第一步：在组件中绑定一个事件处理函数

   例如：将点击事件绑定在组件上的方法：使用bindtap属性，属性值为js中的事件处理函数的函数名

   第二步：在相应的Page定义中写上相应的事件处理函数，参数是event

   例如：对于点击事件：当用户点击该组件的时候会在该页面对应的Page中找到对应的事件处理函数
### 4.6 微信小程序中的数据处理

1. this关键字的使用：

   ​		this：表示当前对象的一个引用。this不是固定不变的，它会随着执行环境的改变而改变。在小程序中，在js文件的任何位置都可以将this当作变量使用。当我们在某个位置使用时，其所指的对象往往是上一层对象。可以使用this来访问页面内的数据或者调用页面内的函数。

   > 访问页面的数据：this.data
   >
   > 调用页面内的函数：this.onload()
   >
   > 注意：在API中使用this，将不会指向页面，无法访问页面数据及函数，需要在调用API之前暂存当时指向页面的this，例如var that=this

2.  小程序中是不能让逻辑层的js直接对视图层进行更新的，只能是首先在视图层建立数据绑定，然后在逻辑层的js中间接对视图层进行更新

   页面数据更新的方法：

   ~~~JavaScript
   this.setData({
       变量名:新的值，
       变量名:新的值
   })
   ~~~

3. 不同页面之间的数据传递：

   参数传递：通过页面跳转过程中携带参数

   全局数据：将数据保存在全局数据中，每个页面再从全局数据中读取，全局数据在根目录的app.json里

   各个页面与全局数据进行交互可以使用语句：getAPP()，例如getAPP().globalData.abc。getAPP()这个对象指向了当前小程序的app.js文件

### 4.7 微信小程序中的API

1. 小程序中API的类型：

   事件监听API：以on开头的API用来监听某个事件是否触发。可接受一个回调函数作为参数

   同步API：微信规定，以Sync为结尾的API都是同步API。同步API的执行结果可以通过函数返回值直接获取，如果执行出错会抛出异常

   异步API：大多数API都是异步API，通常都接受一个Object类型的参数，这个参数都支持按需指定以下字段来接收接口调用结果。异步API调用后系统会另开一个分支去执行，系统自身继续运行。

2. 异步API内容可以有三部分，分别是success部分、fail部分、complete部分，成功执行success，失败执行fail，不管成功还是失败，结束后执行complete

   success、fail、complete函数调用时会传入一个Object类型参数，包含以下字段：errMsg(错误信息)、errCode(错误码)、其他(接口返回的其他数据，一般称作res)，例如：

   ~~~JavaScript
   wx.login({
       success(res){
           //api调用成功执行的代码
       },
       fail(res){
           //api调用失败执行的代码
       },
       complete(res){
           //api调用完毕执行的代码
       }
   })
   ~~~

3. 显示消息提示框

   ~~~javascript
   wx.showToast({
       title:'成功',
       icon:'success',
       duration:2000
   })
   ~~~

   显示对话框

   ~~~javascript
   wx.showModal({
       title:'提示',
       content:'这是一个模态弹窗',
       success(res){
           if(res.confirm){
               console.log('用户点击确定')
           }else if(res.cancel){
               console.log('用户点击取消')
           }
       }
   })
   ~~~

   显示loading提示框

   ~~~javascript
   wx.showLoading({
       title:'加载中',
   })
   //需主动调用wx.hideloading 才能关闭提示框
   ~~~

4. 页面路由API：

   wx.relaunch()关闭所有页面，打开到应用内的某个页面

   wx.redirectTo()关闭当前页面，跳转到应用内的某个页面

   wx.navigateTo()保留当前页面，跳转到应用内的某个页面

   wx.navigateBack()关闭当前页面，返回上一页面或多级页面

   打开页面的顺序实际上是由程序记录的，打开的页面会保存在页面栈中


## 5 服务端后台接口开发实战

### 5.1 网络请求基本知识：

1. PHP能判断用户注册信息是否满足条件，同时操作MySQL数据库进行新增数据、读取数据等操作

2. 客户端将注册信息以HTTP请求的方式(GET方式、POST方式)传送到服务端，服务端处理完后返回数据给客户端，返回数据格式有json格式、xml格式

3. GET请求和POST请求区别：

   GET方式相当于数据写到信纸上进行传输

   POST方式相当于数据放到硬盘中

   |          | GET                                     | POST                |
   | -------- | --------------------------------------- | ------------------- |
   | 请求方式 | 域名/index.php?name1=value&name2=value2 |                     |
   | 可见性   | url中可见参数及其值                     | 参数不会显示在url中 |
   | 长度     | url最长2048个字符                       | 无限制              |
   | 数据类型 | 只允许ASCII字符（视频不行）             | 没有限制            |
   | 安全     | 较差                                    | 较高                |

4. json和xml数据格式的区别：

   json以键值对的方式，以大括号包含数据

   xml是以标签对的方式，把对应值作为闭合标签，值放到标签中

### 5.2 MySQL基本概念入门

1. MySQL是最流行的关系型数据库之一，在web应用开发方面应该是最好用的

2. 一个服务器装一个MySQL，MySQL可以包含多个数据库(database)，一个数据库可以包含多个数据表(table)，一个表包含很多行(row)数据，每行数据包含很多字段(field)的value

3. 对于数据表有四种基本的操作：插入(INSERT)、查询(SELECT)、更新(UPDATE)、删除(DELETE)

4. 把数据表类比成excel表格，表头由多个字段名组成，每一列都是属于同一个字段的。一行称作一条记录，其中哪一列中每一行的值都是唯一的，就称为主键。一个数据表只能包含一个主键，可以使用主键来查询数据。

5. 插入一行数据

   ~~~mysql
   INSERT INTO table_name(field1,field2,...fieldN)
   固定字段      数据表名字    插入的字段名
   			VALUES(value1,value2,...valueN);
   ~~~

   查询数据

   ~~~mysql
   SELECT field1,field2... FROM table_name
   固定字段  目标字段         固定字段 数据表名字
   ~~~

   更新数据

   ~~~mysql
   UPDATE table_name SET field1=new_value1,field2=new_value2 [WHERE Clause]
   例如：
   UPDATE 'user' SET 'POHNE' = '123456' where 'id'=1
   修改id=1的记录，将其手机号变为123456
   ~~~

   删除数据

   ~~~mysql
   DELETE FROM table_name [WHERE Clause]
   例如：
   DELETE FROM 'user' WHERE 'id'=1
   删除id=1的记录
   ~~~

### 5.3 PHP概念入门

1. PHP用来接收请求、查询数据库、返回数据

2. 定义变量要以$开头，使用时无需提前声明。PHP的变量属于弱变量类型，同一个变量可以被不同类型的数据赋值

   PHP调试方法，用浏览器访问对应的函数、打印输出：

   var_dump($a);   //可以打印任何类型数据

   echo $a;             //只可以打印非数组类型

3. PHP会将GET请求中的所有数据放到$_GET中，是一个数组。如果要接收GET请求中phone参数对应的值，使用$a=$__GET['phone']

   POST方式即$a=$_POST['phone']

4. ~~~php
   <?php
   $a="hello world";
   echo $a;
   ?>
   ~~~

   然后在网页里localhost/文件名.php来查看输出

5. Thinkphp是国内最好的php框架

### 5.4 部署云服务器

1. 微信小程序的后台需要设置支持https，并且认证过的服务器
2. 这里使用了新浪云SAE应用服务器来省去了绝大部分的操作，直接来使用代码

## 6 小程序前端+服务端后台连通实战

1. 推荐接口测试工具postman，是web API&HTTP调试与模拟插件，能够发送任何类型的HTTP请求，附带任何数量的参数+headers
2. 微信小程序中使用wx.request来发起网络请求